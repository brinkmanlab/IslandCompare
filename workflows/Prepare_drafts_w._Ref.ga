{"uuid": "1d62e9b0-9601-437e-9581-0f726bbabcf0", "tags": [], "format-version": "0.1", "name": "Prepare drafts w. Ref", "version": 19, "steps": {"0": {"tool_id": null, "tool_version": null, "outputs": [], "workflow_outputs": [{"output_name": "output", "uuid": "3cb64eca-4370-4f2b-8ed4-4fec4c022e05", "label": null}], "input_connections": {}, "tool_state": "{}", "id": 0, "uuid": "2f1564f5-c245-45e6-b272-aae312c18f88", "errors": null, "name": "Input dataset", "label": null, "inputs": [], "position": {"top": 182.1666717529297, "left": 229.1666717529297}, "annotation": "", "content_id": null, "type": "data_input"}, "1": {"tool_id": null, "tool_version": null, "outputs": [], "workflow_outputs": [{"output_name": "output", "uuid": "a35bb8eb-12c5-40bf-ba89-58c8d7dc0c83", "label": null}], "input_connections": {}, "tool_state": "{\"collection_type\": \"list\"}", "id": 1, "uuid": "1881c0cc-8d19-4f7b-8516-c92fb4c5eac7", "errors": null, "name": "Input dataset collection", "label": null, "inputs": [], "position": {"top": 653.8333129882812, "left": 200}, "annotation": "", "content_id": null, "type": "data_collection_input"}, "2": {"tool_id": "biopython-convert", "tool_version": "1.0", "outputs": [{"type": "input", "name": "split_output"}, {"type": "txt", "name": "output"}], "workflow_outputs": [], "input_connections": {"input": {"output_name": "output", "id": 1}}, "tool_state": "{\"__page__\": null, \"__rerun_remap_job_id__\": null, \"split\": \"\\\"false\\\"\", \"query\": \"\\\"\\\"\", \"input\": \"{\\\"__class__\\\": \\\"ConnectedValue\\\"}\", \"output_type\": \"\\\"fasta\\\"\"}", "id": 2, "uuid": "73f173bd-e50a-4b0e-b751-ad252caf00a9", "errors": null, "name": "BioPython SeqIO Converter", "post_job_actions": {"RenameDatasetActionsplit_output": {"output_name": "split_output", "action_type": "RenameDatasetAction", "action_arguments": {"newname": "Split from #{input}"}}, "HideDatasetActionsplit_output": {"output_name": "split_output", "action_type": "HideDatasetAction", "action_arguments": {}}, "HideDatasetActionoutput": {"output_name": "output", "action_type": "HideDatasetAction", "action_arguments": {}}}, "label": "To fasta", "inputs": [], "position": {"top": 265, "left": 596.1666717529297}, "annotation": "", "content_id": "biopython-convert", "type": "tool"}, "3": {"tool_id": "biopython-convert", "tool_version": "1.0", "outputs": [{"type": "input", "name": "split_output"}, {"type": "txt", "name": "output"}], "workflow_outputs": [], "input_connections": {"input": {"output_name": "output", "id": 1}}, "tool_state": "{\"__page__\": null, \"__rerun_remap_job_id__\": null, \"split\": \"\\\"false\\\"\", \"query\": \"\\\"\\\"\", \"input\": \"{\\\"__class__\\\": \\\"ConnectedValue\\\"}\", \"output_type\": \"\\\"gff3\\\"\"}", "id": 3, "uuid": "4f67c15e-8527-42fa-a085-a647516cdc55", "errors": null, "name": "BioPython SeqIO Converter", "post_job_actions": {"HideDatasetActionsplit_output": {"output_name": "split_output", "action_type": "HideDatasetAction", "action_arguments": {}}, "HideDatasetActionoutput": {"output_name": "output", "action_type": "HideDatasetAction", "action_arguments": {}}}, "label": "To GFF", "inputs": [], "position": {"top": 746, "left": 601.1666717529297}, "annotation": "", "content_id": "biopython-convert", "type": "tool"}, "4": {"tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/1.1.1", "tool_version": "1.1.1", "outputs": [{"type": "input", "name": "outfile"}], "workflow_outputs": [], "input_connections": {"infiles_0|infile": {"output_name": "output", "id": 2}}, "tool_state": "{\"__page__\": null, \"code\": \"\\\"# Count number of contigs and output ids of drafts\\\\nBEGIN { i=0; }\\\\n/^>/ { ++i; }\\\\ni > 1 { print tool_input_id; i=0; nextfile }\\\"\", \"last\": \"\\\"false\\\"\", \"infiles\": \"[{\\\"__index__\\\": 0, \\\"infile\\\": {\\\"__class__\\\": \\\"ConnectedValue\\\"}}]\", \"envs\": \"[]\", \"__rerun_remap_job_id__\": null, \"infile\": \"{\\\"__class__\\\": \\\"RuntimeValue\\\"}\"}", "id": 4, "tool_shed_repository": {"owner": "bgruening", "changeset_revision": "a6f147a050a2", "name": "text_processing", "tool_shed": "toolshed.g2.bx.psu.edu"}, "uuid": "b463996b-51c6-46a4-96fb-71ce29493b0e", "errors": null, "name": "Text reformatting", "post_job_actions": {"HideDatasetActionoutfile": {"output_name": "outfile", "action_type": "HideDatasetAction", "action_arguments": {}}}, "label": "Find drafts", "inputs": [{"name": "infile", "description": "runtime parameter for tool Text reformatting"}], "position": {"top": 488.16668701171875, "left": 913.1666870117188}, "annotation": "", "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/1.1.1", "type": "tool"}, "5": {"tool_id": "feature_merge", "tool_version": "1.0", "outputs": [{"type": "gff", "name": "output"}], "workflow_outputs": [{"output_name": "output", "uuid": "346f0f8e-a0fe-4b52-b529-207f37c503e6", "label": "All input annotations"}], "input_connections": {"inputs": {"output_name": "output", "id": 3}}, "tool_state": "{\"ignore_strand\": \"\\\"false\\\"\", \"inputs\": \"{\\\"__class__\\\": \\\"ConnectedValue\\\"}\", \"features\": \"[]\", \"__page__\": null, \"exact_only\": \"\\\"true\\\"\", \"__rerun_remap_job_id__\": null, \"exclude_components\": \"\\\"false\\\"\"}", "id": 5, "uuid": "5205183b-f5f1-42db-a4ca-63295aaa1abb", "errors": null, "name": "GFF/GTF Feature Merge", "post_job_actions": {"RenameDatasetActionoutput": {"output_name": "output", "action_type": "RenameDatasetAction", "action_arguments": {"newname": "Input annotations"}}}, "label": "Merge all features into single file", "inputs": [], "position": {"top": 789, "left": 930.6666870117188}, "annotation": "", "content_id": "feature_merge", "type": "tool"}, "6": {"tool_id": "__FILTER_FROM_FILE__", "tool_version": "1.0.0", "outputs": [{"type": "input", "name": "output_filtered"}, {"type": "input", "name": "output_discarded"}], "workflow_outputs": [], "input_connections": {"input": {"output_name": "output", "id": 2}, "how|filter_source": {"output_name": "outfile", "id": 4}}, "tool_state": "{\"__page__\": null, \"how\": \"{\\\"__current_case__\\\": 1, \\\"filter_source\\\": {\\\"__class__\\\": \\\"ConnectedValue\\\"}, \\\"how_filter\\\": \\\"remove_if_present\\\"}\", \"__rerun_remap_job_id__\": null, \"input\": \"{\\\"__class__\\\": \\\"ConnectedValue\\\"}\"}", "id": 6, "uuid": "e69b1500-7e7b-41b2-b34d-b6e51f612be2", "errors": null, "name": "Filter List", "post_job_actions": {"HideDatasetActionoutput_discarded": {"output_name": "output_discarded", "action_type": "HideDatasetAction", "action_arguments": {}}, "HideDatasetActionoutput_filtered": {"output_name": "output_filtered", "action_type": "HideDatasetAction", "action_arguments": {}}}, "label": "Separate datasets that need stitching", "inputs": [], "position": {"top": 282.16668701171875, "left": 1179.1666870117188}, "annotation": "", "content_id": "__FILTER_FROM_FILE__", "type": "tool"}, "7": {"tool_id": "mauve-contig-mover", "tool_version": "1.0", "outputs": [{"type": "fasta", "name": "merged"}, {"type": "fasta", "name": "reordered"}, {"type": "tabular", "name": "backbone"}, {"type": "tabular", "name": "tab"}], "workflow_outputs": [{"output_name": "tab", "uuid": "60b396e0-29a1-42af-b15b-a76589467a0a", "label": null}, {"output_name": "reordered", "uuid": "b35c878c-3bdf-4712-bfb2-6b7f1ead4830", "label": null}], "input_connections": {"draft": {"output_name": "output_filtered", "id": 6}, "ref": {"output_name": "output", "id": 0}}, "tool_state": "{\"ref\": \"{\\\"__class__\\\": \\\"ConnectedValue\\\"}\", \"__rerun_remap_job_id__\": null, \"draft\": \"{\\\"__class__\\\": \\\"ConnectedValue\\\"}\", \"__page__\": null}", "id": 7, "uuid": "8b15c85f-6ac0-480c-8758-03ec8712cdcb", "errors": null, "name": "Mauve Contig Mover", "post_job_actions": {"HideDatasetActionbackbone": {"output_name": "backbone", "action_type": "HideDatasetAction", "action_arguments": {}}, "HideDatasetActionmerged": {"output_name": "merged", "action_type": "HideDatasetAction", "action_arguments": {}}}, "label": null, "inputs": [], "position": {"top": 163.1666717529297, "left": 1537.1666259765625}, "annotation": "", "content_id": "mauve-contig-mover", "type": "tool"}, "8": {"tool_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/1.1.1", "tool_version": "1.1.1", "outputs": [{"type": "input", "name": "outfile"}], "workflow_outputs": [], "input_connections": {"infile": {"output_name": "reordered", "id": 7}}, "tool_state": "{\"__page__\": null, \"code\": \"\\\"#!/usr/bin/env -S gawk -f \\\\n# Stitch input multi-fastas in order, padding with 'N'.\\\\n\\\\nBEGIN {\\\\n    #Schedule inputs for two passes\\\\n    ARGV[ARGC] = \\\\\\\"pass=sequence\\\\\\\";\\\\n    for (i=1; i<ARGC; ++i)\\\\n        ARGV[ARGC+i] = ARGV[i]\\\\n    ARGC = (ARGC-1) * 2 + 2;\\\\n\\\\n    pass = \\\\\\\"annotations\\\\\\\";\\\\n    FS=\\\\\\\" \\\\\\\"; # Use for parsing fasta header\\\\n    pos=1; # 1-index of stitched sequence\\\\n}\\\\n\\\\nBEGINFILE {\\\\n    first=1;\\\\n    quality=0;\\\\n    if (!stitched_id) {\\\\n        stitched_id = FILENAME;\\\\n        # get basename of FILENAME\\\\n        sub(/^.*\\\\\\\\//, \\\\\\\"\\\\\\\", stitched_id);\\\\n        #sub(/\\\\\\\\.[^.]*$/, \\\\\\\"\\\\\\\", stitched_id);\\\\n        # spaces have special meaning in fasta\\\\n        gsub(\\\\\\\" \\\\\\\", \\\\\\\"_\\\\\\\", stitched_id);\\\\n    }\\\\n    \\\\n    OFS=\\\\\\\"\\\\\\\\t\\\\\\\";\\\\n    ORS=\\\\\\\"\\\\\\\\n\\\\\\\";\\\\n    if (pass == \\\\\\\"annotations\\\\\\\") {\\\\n        print \\\\\\\"##gff-version 3\\\\\\\";\\\\n        OFS=\\\\\\\"\\\\\\\\t\\\\\\\";\\\\n        ORS=\\\\\\\"\\\\\\\\n\\\\\\\";\\\\n    } else if (pass == \\\\\\\"sequence\\\\\\\") {\\\\n        print \\\\\\\"##FASTA\\\\\\\";\\\\n        print \\\\\\\">\\\\\\\" stitched_id;\\\\n        ORS=\\\\\\\"\\\\\\\";\\\\n        OFS=\\\\\\\"\\\\\\\";\\\\n    }\\\\n}\\\\n\\\\n# Reset quality state\\\\n/^>/ {\\\\n    quality=0;\\\\n}\\\\n\\\\n# Store sequence information\\\\npass == \\\\\\\"annotations\\\\\\\" && /^>/ {\\\\n    if (current_id) {\\\\n        # Output record\\\\n        print stitched_id, \\\\\\\"stitch.gawk\\\\\\\", \\\\\\\"contig\\\\\\\", start, pos-1, \\\\\\\".\\\\\\\", \\\\\\\".\\\\\\\", \\\\\\\".\\\\\\\", \\\\\\\"ID=\\\\\\\"current_id;\\\\n    }\\\\n    current_id=substr($1, 2);\\\\n    if (first) {\\\\n        first=0;\\\\n    } else {\\\\n        pos += ENVIRON[\\\\\\\"padding_length\\\\\\\"];\\\\n    }\\\\n    start = pos;\\\\n    next;\\\\n}\\\\n\\\\npass == \\\\\\\"annotations\\\\\\\" && !quality {\\\\n    pos += length();\\\\n}\\\\n\\\\n# Output sequence\\\\npass == \\\\\\\"sequence\\\\\\\" && /^>/ {\\\\n    if (first) {\\\\n        first=0;\\\\n    } else {\\\\n        for (i = 0; i < ENVIRON[\\\\\\\"padding_length\\\\\\\"]; ++i)\\\\n            if (pass == \\\\\\\"sequence\\\\\\\")\\\\n                print \\\\\\\"N\\\\\\\";\\\\n    }\\\\n    next;\\\\n}\\\\n\\\\n# Default print if not quality lines\\\\npass == \\\\\\\"sequence\\\\\\\" && !quality {\\\\n    print;\\\\n}\\\\n\\\\n# Allow for fastq input\\\\n/^+/ { quality=1; next }\\\\n\\\\nENDFILE {\\\\n    pass = next_pass[pass]\\\\n    if (pass) {\\\\n        # Set next file to this one for second pass\\\\n\\\\n        \\\\n    }\\\\n}\\\"\", \"last\": \"\\\"false\\\"\", \"infiles\": \"[]\", \"envs\": \"[{\\\"__index__\\\": 0, \\\"name\\\": \\\"padding_length\\\", \\\"val\\\": \\\"1000\\\"}]\", \"__rerun_remap_job_id__\": null, \"infile\": \"{\\\"__class__\\\": \\\"RuntimeValue\\\"}\"}", "id": 8, "tool_shed_repository": {"owner": "bgruening", "changeset_revision": "a6f147a050a2", "name": "text_processing", "tool_shed": "toolshed.g2.bx.psu.edu"}, "uuid": "1ce350bc-2d03-4b5f-970a-b7c660709306", "errors": null, "name": "Text reformatting", "post_job_actions": {"HideDatasetActionoutfile": {"output_name": "outfile", "action_type": "HideDatasetAction", "action_arguments": {}}, "RenameDatasetActionoutfile": {"output_name": "outfile", "action_type": "RenameDatasetAction", "action_arguments": {"newname": "Genomes stiched in order"}}}, "label": "Stitch in order", "inputs": [{"name": "infile", "description": "runtime parameter for tool Text reformatting"}], "position": {"top": 510.16668701171875, "left": 1859.1666259765625}, "annotation": "", "content_id": "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_awk_tool/1.1.1", "type": "tool"}, "9": {"tool_id": "__MERGE_COLLECTION__", "tool_version": "1.0.0", "outputs": [{"type": "input", "name": "output"}], "workflow_outputs": [{"output_name": "output", "uuid": "19fc80aa-4b6e-45aa-97d2-c8195a456e95", "label": null}], "input_connections": {"inputs_0|input": {"output_name": "outfile", "id": 8}, "inputs_1|input": {"output_name": "output_discarded", "id": 6}}, "tool_state": "{\"inputs\": \"[{\\\"__index__\\\": 0, \\\"input\\\": {\\\"__class__\\\": \\\"ConnectedValue\\\"}}, {\\\"__index__\\\": 1, \\\"input\\\": {\\\"__class__\\\": \\\"ConnectedValue\\\"}}]\", \"__rerun_remap_job_id__\": null, \"advanced\": \"{\\\"conflict\\\": {\\\"__current_case__\\\": 3, \\\"duplicate_options\\\": \\\"keep_first\\\"}}\", \"__page__\": null}", "id": 9, "uuid": "030147dd-40f2-4947-9c21-73dccee5fa16", "errors": null, "name": "Merge Collections", "post_job_actions": {"RenameDatasetActionoutput": {"output_name": "output", "action_type": "RenameDatasetAction", "action_arguments": {"newname": "Stitched Genomes"}}}, "label": "Merge sorted collections of collections", "inputs": [], "position": {"top": 567.1666870117188, "left": 2108.1666259765625}, "annotation": "", "content_id": "__MERGE_COLLECTION__", "type": "tool"}}, "annotation": "", "a_galaxy_workflow": "true"}