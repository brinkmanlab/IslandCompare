<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>IslandCompare - Alignment</title>
    <script src="static/vendor/foundation-6/js/vendor/jquery.min.js"></script>
    <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="static/vendor/D3Addons/d3.phylogram.js"></script>
    <script src="static/vendor/D3Addons/newick.js"></script>
    <script src="/static/genomeManage/js/alignervis.js"></script>
    <link rel="stylesheet" href="static/genomeManage/css/linearplot.css" />
</head>
<body>

    <div id="alignmentControls">
        <div class="controlRow">
            <div class="controlBody">
                <span id="#controlTitle">Controls: </span>
                <button id="resetTree">Reset Tree</button>
                <button id="resetRange">Reset Zoom</button>
                <button id="toggleBranchLength">Toggle Branches</button>
                <button id="printerColors">Toggle Grayscale</button>
            </div>
            <div class="legendBody">
                <span id="legendTitle">Legend: </span>
                <span class="legendText">Genomic Island</span>
                <svg id="genomicIslandLegend" height="10" width="10">
                    <circle cx="5" cy="5" r="4" stroke-width="1"></circle>
                </svg>
                <span class="legendText">Genes</span>
                <svg id="genesLegend" height="10" width="10">
                    <circle cx="5" cy="5" r="4" stroke-width="1"></circle>
                </svg>
                <span class="legendText">Homologous Region</span>
                <svg id="homologosRegionLegend" height="10" width="10">
                    <circle cx="5" cy="5" r="4" stroke-width="1"></circle>
                </svg>
                <span class="legendText">Genome</span>
                <svg id="genomeLegend" height="10" width="10">
                    <circle cx="5" cy="5" r="4" stroke-width="1"></circle>
                </svg>
            </div>
            <!--
            --Currently Not used
            <div class="controlSide">
                <button id="toggleControls">(<<)</button>
            </div>
            -->
        </div>
    </div>
    <div id="alignmentContainer"></div>

    <script>
        var isPrinterColors = false;
        var container = new MultiVis("#alignmentContainer");

        //Below function constructs tree from JSON mauve output from server
        container.backbone.retrieveJsonAndRender(container,"/getAlignerData?id={{id}}","/getGenesData?id={{id}}");

        // Add listeners to button controls
        $(document).ready(function(){
            //Button resets any tree zooming that was done
            $("#resetTree").on("click",this,function(){
                container.resetAndRenderGraph();
            });
            //Button resets the range of the linear plot to (0,maxSize)
            $("#resetRange").on("click",this,function(){
                container.resetAndRenderRange();
            });
            //Button toggles if show true branch lengths or not
            $("#toggleBranchLength").on("click",this,function(){
                container.toggleTrueBranchLengths();
                container.transition();
            });

            //Button toggles printer colors on the linear plot
            $("#printerColors").on("click",this,function(){
                container.togglePrinterColors();
                container.render();

                // Update the Legend Colors
                isPrinterColors = !isPrinterColors;
                if (isPrinterColors){
                    $("#genomicIslandLegend").attr("class", "#genomicIslandsLegend print");
                    $("#genesLegend").attr("class", "#genesLegend print");
                    $("#genomeLegend").attr("class", "#genomeLegend print");
                }
                else{
                    $("#genomicIslandLegend").attr("class", "#genomicIslandsLegend");
                    $("#genesLegend").attr("class", "#genesLegend");
                    $("#genomeLegend").attr("class", "#genomeLegend");
                }
            });
            //Button that toggles the control div left or right
            //Currently not used
            /*
            $('#toggleControls').click(function(event) {
                controlwidth = $('.controlBody').css('width');
                value = $('#alignmentControls').css('left') === ('-'+controlwidth) ? 0 : ('-'+controlwidth);
                $('#alignmentControls').animate({
                    left: value
                });
            });
            */
        })
    </script>
</body>
</html>